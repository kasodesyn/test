{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { ethers, BigNumber } from \"ethers\";\nimport Token from \"../../contracts/Token.json\";\nimport { proof, isIncludes, whiteList } from \"./data\";\nconst addressForTest = \"0x2fc5fF3c967274E0A32F64eA031CA886A7e7BC43\";\nconst MainMit = _ref => {\n  _s();\n  let {\n    accounts\n  } = _ref;\n  console.log(\"accounts\", accounts);\n  const [flag, setFlag] = useState(false);\n  const [value, setValue] = useState(1);\n  const isConnected = Boolean(accounts[0]);\n  const [isWhiteList, setIsWhiteList] = useState(false);\n  useEffect(() => {\n    const bools = whiteList.includes(accounts[0]);\n    setIsWhiteList(bools);\n  }, [accounts]);\n  async function handleMint() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(addressForTest,\n      // 合约地址\n      Token.abi, signer);\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n        const name = await contract.name();\n        setFlag(false);\n        console.log(name, \"name\");\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    }\n  }\n  async function handleMintGuest() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(addressForTest,\n      // 合约地址\n      Token.abi, signer);\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n        const response = await contract.mintGuest(BigNumber.from(value), {\n          value: ethers.utils.parseEther((0.08 * value).toString())\n        });\n        window.alert(\"success!\");\n        setFlag(false);\n        console.log(\"response\", response);\n      } catch (err) {\n        console.log(\"error\", err);\n        window.alert(\"fail!\");\n      }\n    }\n  }\n  async function handleMintWhiteList() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(addressForTest,\n      // 合约地址\n      Token.abi, signer);\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n        await contract.mintWhiteList(proof, value, {\n          value: ethers.utils.parseEther((0.06 * value).toString())\n        });\n        setFlag(false);\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    }\n  }\n\n  // -\n  const handlerDecrement = () => {\n    if (value - 1 === 0) {\n      console.log(value, \"value\");\n      return;\n    }\n    setValue(pre => pre - 1);\n  };\n  // +\n  const handlerIncrement = () => {\n    if (value + 1 === 6) {\n      console.log(value, \"value\");\n      return;\n    }\n    setValue(pre => pre + 1);\n  };\n  return {\n    handleMint,\n    handlerDecrement,\n    handlerIncrement,\n    isConnected,\n    flag,\n    handleMintGuest,\n    handleMintWhiteList,\n    isWhiteList,\n    value\n  };\n};\n_s(MainMit, \"lZNVOxWUz8JaATYMhheTQmYKBXo=\");\n_c = MainMit;\nexport default MainMit;\nvar _c;\n$RefreshReg$(_c, \"MainMit\");","map":{"version":3,"names":["useEffect","useState","ethers","BigNumber","Token","proof","isIncludes","whiteList","addressForTest","MainMit","accounts","console","log","flag","setFlag","value","setValue","isConnected","Boolean","isWhiteList","setIsWhiteList","bools","includes","handleMint","window","ethereum","provider","providers","Web3Provider","signer","getSigner","contract","Contract","abi","name","err","handleMintGuest","response","mintGuest","from","utils","parseEther","toString","alert","handleMintWhiteList","mintWhiteList","handlerDecrement","pre","handlerIncrement"],"sources":["/Users/kasoqian/Downloads/web3-react/src/pages/mint/utils.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { ethers, BigNumber } from \"ethers\";\nimport Token from \"../../contracts/Token.json\";\nimport { proof, isIncludes, whiteList } from \"./data\";\n\nconst addressForTest = \"0x2fc5fF3c967274E0A32F64eA031CA886A7e7BC43\";\n\nconst MainMit = ({ accounts }) => {\n  console.log(\"accounts\",accounts)\n  const [flag, setFlag] = useState(false);\n  const [value, setValue] = useState(1);\n  const isConnected = Boolean(accounts[0]);\n  const [isWhiteList,setIsWhiteList] = useState(false)\n\n  useEffect(()=>{\n    const bools = whiteList.includes(accounts[0])\n    setIsWhiteList(bools)\n  },[accounts])\n\n  async function handleMint() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(\n        addressForTest, // 合约地址\n        Token.abi,\n        signer\n      );\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n\n        const name = await contract.name();\n        setFlag(false);\n        console.log(name, \"name\");\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    }\n  }\n\n  async function handleMintGuest() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(\n        addressForTest, // 合约地址\n        Token.abi,\n        signer\n      );\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n        const response = await contract.mintGuest(BigNumber.from(value), {\n          value: ethers.utils.parseEther((0.08 * value).toString()),\n        });\n        window.alert(\"success!\");\n        setFlag(false);\n        console.log(\"response\", response);\n      } catch (err) {\n        console.log(\"error\", err);\n        window.alert(\"fail!\");\n      }\n    }\n  }\n  async function handleMintWhiteList() {\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(\n        addressForTest, // 合约地址\n        Token.abi,\n        signer\n      );\n      try {\n        if (flag) {\n          return;\n        }\n        setFlag(true);\n        await contract.mintWhiteList(proof, value, {\n          value: ethers.utils.parseEther((0.06 * value).toString()),\n        });\n        setFlag(false);\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    }\n  }\n\n  // -\n  const handlerDecrement = () => {\n    if (value - 1 === 0) {\n      console.log(value, \"value\");\n      return;\n    }\n    setValue((pre) => pre - 1);\n  };\n  // +\n  const handlerIncrement = () => {\n    if (value + 1 === 6) {\n      console.log(value, \"value\");\n      return;\n    }\n    setValue((pre) => pre + 1);\n  };\n\n  return {\n    handleMint,\n    handlerDecrement,\n    handlerIncrement,\n    isConnected,\n    flag,\n    handleMintGuest,\n    handleMintWhiteList,\n    isWhiteList,\n    value,\n  };\n};\n\nexport default MainMit;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}